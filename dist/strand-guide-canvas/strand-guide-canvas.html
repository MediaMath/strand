<!--
 * @license
 * Copyright (c) 2015 MediaMath Inc. All rights reserved.
 * This code may only be used under the BSD style license found at http://mediamath.github.io/strand/LICENSE.txt
 --><html><head><meta charset="UTF-8"></head><body><div hidden by-vulcanize=""><link rel="import" href="../../bower_components/polymer/polymer.html"><script>!function(i){function t(){var i=[].slice.call(arguments);this.data=[];for(var t=0;t<i.length;t++)this[i[t]]=1<<t,this.data[1<<t]=i[t]}i.BitMask=t}(window.StrandLib=window.StrandLib||{});</script><script>!function(t){function i(t,i,e,n){this.x=t,this.y=i,this.width=e,this.height=n}i.fromElement=function(t){if(t&&t.getBoundingClientRect){var e=t.getBoundingClientRect();return new i(e.left,e.top,e.width,e.height)}return new i(0,0,0,0)},i.fixBits=function(t,e,n,h){e&=n;var o=t&i.SIDE.CENTER,s=t&i.SIDE.VCENTER;return o||s?e&&(t|=e^n,s&&(t&=~i.SIDE.VCENTER),o&&(t&=~i.SIDE.CENTER)):0!==(e&n)&&(e&n)!==n&&(t=t&~n|t^n),t},i.SIDE=new t.BitMask("TOP","BOTTOM","LEFT","RIGHT","CENTER","VCENTER"),i.prototype={get left(){return this.x},set left(t){this.x=t},get right(){return this.x+this.width},set right(t){this.x=t-this.width},get top(){return this.y},set top(t){this.y=t},get bottom(){return this.y+this.height},set bottom(t){this.y=t-this.height},get center(){return this.x+this.width/2},set center(t){this.x=t-this.width/2},get vcenter(){return this.y+this.height/2},set vcenter(t){this.y=t-this.height/2},clone:function(){return new i(this.x,this.y,this.width,this.height)},outside:function(t){var e=0,n=i.SIDE;return this.left<t.left&&(e|=n.LEFT),this.right>t.right&&(e|=n.RIGHT),this.top<t.top&&(e|=n.TOP),this.bottom>t.bottom&&(e|=n.BOTTOM),e},toCSS:function(t,i){return t&&t.style&&(i?(t.style.left=this.left+"px",t.style.top=this.top+"px"):(t.style.left=Math.round(this.left)+"px",t.style.top=Math.round(this.top)+"px")),this},positionRelative:function(t,e){var n=i.SIDE;return n.LEFT&e&&(this.right=t.left),n.RIGHT&e&&(this.left=t.right),n.TOP&e&&(this.bottom=t.top),n.BOTTOM&e&&(this.top=t.bottom),n.CENTER&e&&(this.center=t.center),n.VCENTER&e&&(this.vcenter=t.vcenter),this},subtract:function(t){this.x-=t.x,this.y-=t.y},flipV:function(){this.y=-this.y},flipH:function(){this.x=-this.x},alignRelative:function(t,e){var n=i.SIDE;return n.LEFT&e&&(this.left=t.left),n.RIGHT&e&&(this.right=t.right),n.TOP&e&&(this.bottom=t.bottom),n.BOTTOM&e&&(this.top=t.top),n.CENTER&e&&(this.center=t.center),n.VCENTER&e&&(this.vcenter=t.vcenter),this}},t.Rectangle=i}(window.StrandLib=window.StrandLib||{});</script></div><dom-module id="strand-guide-canvas"><template><style>:host{position:relative;display:block}:host([hidden]) #blocker{display:none}#blocker{position:fixed;left:0;top:0;bottom:0;right:0}</style><canvas id="canvas"></canvas></template></dom-module><script>!function(t){function e(t,e,i,a,s,h,n){s||(s=0),h||(h=2*Math.PI),t.save(),t.beginPath(),t.arc(e,i,a,s,h),n&&(t.strokeStyle=n),t.stroke(),t.restore()}function i(t,e,i,a,s,h,n){a<2*h&&(h=a/2),s<2*h&&(h=s/2),t.save(),t.beginPath(),t.moveTo(e+h,i),t.arcTo(e+a,i,e+a,i+s,h),t.arcTo(e+a,i+s,e,i+s,h),t.arcTo(e,i+s,e,i,h),t.arcTo(e,i,e+a,i,h),t.closePath(),t.restore()}var a=StrandLib.Rectangle;t.Guide=Polymer({is:"strand-guide-canvas",behaviors:[StrandTraits.WindowNotifier],properties:{hidden:{type:Boolean},opacity:{type:Number,value:.3},data:{type:Array},currentStep:{type:Number,notify:!0,observer:"_currentStepChanged"},spotlightType:String,spotlightOffset:Number,cornerRadius:Number},resize:function(){this.hidden||this.debounce("update-canvas",this._updateCanvas)},scroll:function(){this.hidden||this.debounce("update-canvas",this._updateCanvas)},_currentStepChanged:function(t,e){this.currentStep<=this.data.length-1&&this._updateCanvas()},_updateCanvas:function(){if(this.data){var t=this.data[this.currentStep].targetRef,s=a.fromElement(t),h=this.$.canvas,n=h.getContext("2d"),r=n.canvas.width=window.innerWidth,o=n.canvas.height=window.innerHeight;this.spotlightRadius,this.spotlightOffset;if(h.width=r,h.height=o,n.fillStyle="rgba(0,0,0,"+this.opacity+")",n.fillRect(0,0,r,o),n.globalCompositeOperation="destination-out",n.fillStyle="red","circle"===this.spotlightType){var d=s.width>s.height?s.width:s.height;e(n,s.x+s.width/2,s.y+s.height/2,d/2+this.spotlightOffset)}else i(n,s.x-this.spotlightOffset,s.y-this.spotlightOffset,s.width+2*this.spotlightOffset,s.height+2*this.spotlightOffset,this.cornerRadius);n.fill()}}})}(window.Strand=window.Strand||{});</script></body></html>