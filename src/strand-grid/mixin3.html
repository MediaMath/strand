<!DOCTYPE html>
<html>
<head>
	<script language="javascript" src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
	<link rel="import" href="strand-grid.html">
	<style type="text/css">
		html, body {
			padding: 0;
			margin: 0;
			background: #eee;
			width: 100%;
			height: 100%;
			min-height: 100%;
		}

		*[unresolved] {
			display: none;
		}

		strand-grid {
			height: 100%;
		}

		div[field="drag"] {
			width: 100px;
			height:20px;
			background: #555555;
		}

	</style>
</head>
<body>
	<dom-module id="some-adapter">
		<script>
			HTMLImports.whenReady(function() {
				Polymer({
					is:"some-adapter",
					behaviors: [
						StrandTraits.MixinFindable,
					],

					properties: {
						data: {
							type: Array,
							notify: true,
						},
					},

					mixinsForValue: function (value) {
						if (value.id === "potentiallyUsedForDifferentiatingInvocationsTo-mixinsForValue" &&
							value instanceof HTMLTemplateElement) {
							return [{
								_customClick: function (ev) {
									console.log("_customClick", ev);
								},
								_customHover: function (ev) {
									console.log("_customHover", ev);
								},
							}, {
								_customDrag: function (ev) {
									console.log("_customDrag", ev);
								},
							}];
						}
					},
				});
			});
		</script>
	</dom-module>

	<template is="dom-bind" id="mmTestGridApp">
		<!-- some-adapter must be a child preceding the strand-grid for the "someAdapter" bind to work properly -->
		<some-adapter id="mmTestGridController" mixin-findable="{{someAdapter}}"></some-adapter>

		<strand-grid id="mmTestGrid" gpu="4d" selectable unresolved data="{{data}}" mixin-findable="{{someAdapter}}">
			<strand-grid-column width="10%" field="drag">DRAG</strand-grid-column>

			<strand-grid-column width="10%" field="id" sort resize>Id</strand-grid-column>
			<strand-grid-column width="20%" field="name" sort resize>Name</strand-grid-column>
			<strand-grid-column width="10%" field="advertiser" sort resize>Advertiser</strand-grid-column>
			<strand-grid-column width="10%" field="concept" sort resize>Concept</strand-grid-column>
			<strand-grid-column width="10%" field="type" resize>Type</strand-grid-column>
			<strand-grid-column width="10%" field="dimensions">Dimensions</strand-grid-column>

			<template preserve-content id="potentiallyUsedForDifferentiatingInvocationsTo-mixinsForValue">
				<strand-grid-item model="{{model}}" scope="{{scope}}">
					<div field="drag" on-track="_customDrag"></div>
					<div field="id" on-mouseover="_customHover">HOVER {{model.id}}</div>
					<div field="name" on-click="_customClick">CLICK {{model.name}}</div>
				</strand-grid-item>
			</template>
		</strand-grid>
	</template>

	<script type="text/javascript">
		var data = [],
			columns = [
				{field: "id", label:"id", width:"10%"},
				{field: "name", label: "Name Here", width: "25%", resize: true, info: true},
				{field: "advertiser", label: "Advertiser", width: "20%", resize: true, align:"right"},
				{field: "concept", label: "Concept", width: "15%", resize: true, align:"right"},
				{field: "type", label: "Type", width: "15%", resize: true, align:"right"},
				{field: "dimensions", label: "Dimensions", width: "15%", align:"right"}
			],
			app, 
			NUM_ITEMS = 300;

		for(var i=0; i<NUM_ITEMS; i++) {
			generateItem();
		}

		if (data.length) {
			data[0].content = new Array(100).join(" "+data[0].name);
			data[0|(data.length / 2)].content = new Array(100).join(" "+data[0|(data.length / 2)].name);
			data[data.length - 1].content = new Array(100).join(" "+data[data.length - 1].name);
		}

		function generateItem() {
			data.push({
				id: i,
				name: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi odio justo, vulputate eu consequat quis, ullamcorper sed ipsum. Nullam molestie, urna sed facilisis suscipit, leo urna molestie lorem, nec tincidunt ipsum tellus sit amet velit. Nulla pulvinar mi et commodo blandit.',
				content: Math.random().toString(36).substring(7),
				advertiser: "Advertiser No. " + i,
				concept: "Concept No. " + i,
				type: "swf",
				file: "Creative_File_" + i + ".swf",
				dimensions: String(Math.floor(Math.random()*300) + " x " + Math.floor(Math.random()*300)),
				selected: false,
				expanded: false,
			});
		}

		window.addEventListener("WebComponentsReady", function() {
			app = document.querySelector("#mmTestGridApp");
			app.data = data;

		});
	</script>
</body>
</html>
