<!--
@license
Copyright (c) 2015 MediaMath Inc. All rights reserved.
This code may only be used under the BSD style license found at http://mediamath.github.io/strand/LICENSE.txt
-->
<script type="text/javascript">
(function (scope) {

	scope.SizeResponsible = {

		properties: {
			_alias:{
				type: Object,
				value: function() {
					return this;
				}
			},
		},

		addResizeListener: function(fn, target) {
			this._listeners = this._listeners || [];
			var el = target || this;
			var element = Polymer.dom(el);

			if (el.style.position !== "relative") {
				el.style.position = "relative";
			}

			var div = document.createElement("div");
			div.style.cssText = "position:absolute; width:auto; height:auto; top:0; right:0; bottom:0; left:0; margin:0; padding:0; overflow:hidden; visibility:hidden; z-index:-1";
			var iframe = document.createElement("iframe");
			iframe.style.cssText = "width:100%; height:100%; border:0; visibility:visible; margin:0";

			div.appendChild(iframe);
			element.appendChild(div);

			iframe.cb = fn;
			if (iframe.contentWindow) {
				iframe.contentWindow.stop();
				iframe.contentWindow.addEventListener("resize", fn);
			} else {
				iframe.addEventListener("load", function handler () {
					iframe.removeEventListener("load", handler);
					iframe.contentWindow.addEventListener("resize", fn);
				});
			}

			this._listeners.push({
				div:div,
				iframe:iframe,
				fn:fn,
				target:target
			});
		},

		removeResizeListener: function(fn, target) {
			var f = this._listeners.filter(function(t) {
				return t.fn === fn || t.target === target;
			}).map(function(listen) {
				listen.target.removeChild(listen.div);
				if (listen.iframe.contentWindow) {
					listen.iframe.contentWindow.removeEventListener("resize",listen.fn);
				}
				return this._listeners.indexOf(listen);
			}, this).forEach(function(idx) {
				this._listeners.splice(idx,1);
			}, this);
		}

	};

})(window.StrandTraits = window.StrandTraits || {}); 
</script>