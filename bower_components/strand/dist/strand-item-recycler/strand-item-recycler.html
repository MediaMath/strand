<!--
 * @license
 * Copyright (c) 2015 MediaMath Inc. All rights reserved.
 * This code may only be used under the BSD style license found at http://mediamath.github.io/strand/LICENSE.txt
 --><html><head><meta charset="UTF-8"></head><body><div hidden by-vulcanize=""><link rel="import" href="../../bower_components/polymer/polymer.html"><script language="javascript">(function(a){a.Snake=function(b){return b("","",b)}(function(c,d,f){function g(p,q,r){arguments.length;var s=p||q||null;this._head=null,this._tail=null,this._count=0,this._leader=this,this.__guid=j++,this.body=null,s=s||this,this._connect(p||s,q||s,null),this._leader=s._validLeader()||r}function h(){return g}function i(p){this.push(0|p.__guid)}var j=1,k={},l=c||"",m=d||"",n=null,o=1;try{m||(m=f.toString(),l=m.slice(0,m.indexOf(")")),l=l.slice(l.indexOf("(")+1),m=m.slice(m.indexOf("{")+1),m=m.slice(0,m.lastIndexOf("}"))),n=Function(l,m)}catch(p){}return g.prototype.implementationFactory=function(){var p=(n||h)(l,m,"() { throw new Error('could not resolve Snake implementation body'); }");return n&&(n=Function(l,m)),p},g.prototype.provide=function(p,q,r){return new g(p||null,q||p||null,r||null)},g.prototype.__breakpoint=function(p){if(o||p)debugger;o=0},g.prototype.__seq=function(p){var q=this._validLeader(),r=Array.isArray(p)?p:q?[]:null;return q&&q.eachTailwise(i,r),r},g.prototype.__log=function(){var p=this._validLeader(),q=p?[]:null;console.log(this.__guid,q,0|(p&&p.__guid)),console.log(this.__seq(q))},g.prototype.__tuple=function(){return[0|this.__guid,0|(this._head&&this._head.__guid),0|(this._tail&&this._tail.__guid),0|(this._leader&&this._leader.__guid)]},g.prototype._validLeader=function(){var p=this._leader,q=p&&p._head,r=p&&p._tail;return q&&r&&q._head===p&&r._tail===p?p:null},g.prototype.getLeader=function(){return this._validLeader()},g.prototype._isCoiled=function(){return 0|(this._head===this&&this._tail===this&&this._leader===this)},g.prototype._recoil=function(){this._head=this,this._tail=this,this._leader=this,this._count=0},g.prototype.setBody=function(p){return this.body=p,this},g.prototype.getHead=function(p){var q=0|p,r=this._head;if(r&&r._head!==this)for(;r&&0<q--;)r=r.getHead(0);else if(this===r||this!==this._validLeader())r=null;else for(;r&&0<q--;)r=r.getTail(0);return r},g.prototype.getTail=function(p){var q=0|p,r=this._tail;if(r&&r._tail!==this)for(;r&&0<q--;)r=r.getTail(0);else if(this===r||this!==this._validLeader())r=null;else for(;r&&0<q--;)r=r.getHead(0);return r},g.prototype.getCount=function(){var p=this._validLeader();return 0|(p&&p._count)},g.prototype._swap=function(){var p=this._head;return this._head=this._tail,this._tail=p,this},g.prototype.addHead=function(p){return p&&!p._isCoiled()?null:this._addSnake(this._head,this,p||null)},g.prototype.addTail=function(p){return p&&!p._isCoiled()?null:this._addSnake(this,this._tail,p||null)},g.prototype._addSnake=function(p,q,r){var s=this._validLeader(),t=s===q?q._swap():s===p?p._swap():null,u=r?r._connect(p,q,s):new g(p,q,s);return t?this===s?(this._inject(u,q,p),u._swap(),t._swap()):(this._inject(u,p,q),t._swap()):this._inject(u,p,q),s._count++,u},g.prototype._connect=function(p,q,r){return this._head=p,this._tail=q,this._leader=r||this._validLeader(),this},g.prototype._inject=function(p,q,r){r._head=p,q._tail=p},g.prototype.dropAnyway=function(p){for(var q=arguments.length?0|p:1,r=this;r&&0<q--;)r=r._dropSnake(r._head,r._tail);return r},g.prototype.dropHeadwise=function(p){for(var q=arguments.length?0|p:1,r=this;r&&0<q--;)r=r._dropSnake(r._head,null);return r},g.prototype.dropTailwise=function(p){for(var q=arguments.length?0|p:1,r=this;r&&0<q--;)r=r._dropSnake(null,r._tail);return r},g.prototype._dropSnake=function(p,q){var r=this._validLeader(),s=p||q;return this!==r&&(this._eject(this,this._head,this._tail,r),r._count--),s===this?null:s},g.prototype._eject=function(p,q,r,s){var t=s===r?r._swap():s===q?q._swap():null;q._tail=r,r._head=q,p&&p._recoil(),t&&t._swap()},g.prototype.eachHeadwise=function(p,q,r,s,t){var u=this._validLeader(),v=this===u?this.getTail():this;return this._each(this.getHead,u,v,p,q,r,s,t)},g.prototype.eachTailwise=function(p,q,r,s,t){var u=this._validLeader(),v=this===u?this.getHead():this;return this._each(this.getTail,u,v,p,q,r,s,t)},g.prototype._each=function(p,q,r,s,t,u,v,w){for(var x=r,y=0,z=t||this,A=0|this.getCount();x&&k!==s.call(z,x,y++,q,A,k,s,u,v,w);)x=p.call(x);return x},g})})(window);</script><script language="javascript">(function(a){function b(){var n=arguments.length,o=0,p=-1;for(o;o<n;o++)p&=0|arguments[o];return p}function c(n,o,p){this._elevation=0,this._height=0,this._bits=h,this.reset(+n||0,+o||0).rebit(0|p)}function d(){this._array=Array.apply(null,arguments)}function e(){var n=new d(l);return n.pop(),n}function f(n,o){this._indexWithLazyExtent=0,this._items=("function"==typeof o?o:e)(),this._getInitialHeight=null,this._getInitialHeight="function"==typeof n?n:function(){return 40}}function g(n){var o=l;return-1<n&&n<this._items.length()?o=this._items.get(n):-1>n&&(o=null),o&&n<this._indexWithLazyExtent&&o.knowsExtent()?o:null}var h=0,i=1,j=2,k=4;c.prototype._mutate=function(){if(b(this._bits,i))throw new Error("static Segments MUST NOT be modified")},c.prototype.reset=function(n,o){switch(this._mutate(),arguments.length){default:case 2:this._height=+o||0;case 1:this._elevation=+n||0;case 0:}return this},c.prototype.rebit=function(n,o){return this._mutate(),this._bits&=~(0|o),this._bits|=0|n,this},c.prototype.knowsHeight=function(){return b(this._bits,j)?1:0},c.prototype.knowsElevation=function(){return b(this._bits,k)?1:0},c.prototype.knowsExtent=function(){return this.knowsHeight()&&this.knowsElevation()},c.prototype.getExtent=function(){return this.knowsExtent()?this._elevation+this._height||0:-1},c.prototype.getHeight=function(){return this._height},c.prototype.getElevation=function(){return this._elevation},c.prototype.getBits=function(){return this._bits},d.prototype.pop=function(){return this._array.pop.apply(this._array,arguments)},d.prototype.push=function(){return this._array.push.apply(this._array,arguments)},d.prototype.length=function(){return this._array.length},d.prototype.get=function(n){return this._array[n]},d.prototype.set=function(n,o){return this._array[n]=o},d.prototype.useSlice=function(){this._array=this._array.slice.apply(this._array,arguments)},d.prototype.add=function(n,o,p,q){var r=0|q,s=[,,];return s[0]=0|n,s[1]=0,Array.isArray(p)?r&&s.push.apply(s,p.slice(r,r+(0|o))):s.push.apply(s,Array(o)),s.length<o+2&&s.push.apply(s,Array(o+2-s.length)),this._array.splice.apply(this._array,s),o},d.prototype.remove=function(n,o){return-this._array.splice(0|n,0|o).length};var l=new c(0,0,function(){var o=arguments.length,p=0,q=0;for(p;p<o;p++)q|=0|arguments[p];return q}(k,j)).rebit(i),m=new c(-1,-1,h).rebit(i);Snake.prototype.implementationFactory(),Snake.prototype.implementationFactory(),f.prototype.getDiscreteCount=function(){return this._items.length()},f.prototype._segment=function(n){var o=l,p=l;return this._items.length()>n&&-1<n?(this._items.get(n)===m&&(0<n&&(p=this._items.get(n-1)),o=this._items.set(n,new c(0,0,h)),p.knowsExtent()&&o.reset(p.getExtent()).rebit(k)),1):0},f.prototype._fill=function(n){var o=this._items.length(),p=n+1,q=p-o;for(o;o<p;o++)this._items.push(m);return this._segment(n),q},f.prototype._lazyHeight=function(n,o){var p=+n.getHeight()||0;return n.knowsHeight()||(p=+this._getInitialHeight(o,this)||0,n.reset(n.getElevation(),p).rebit(j)),p},f.prototype._elevate=function(n,o){var p=l;o.knowsExtent()&&(this._segment(n)?(p=this._items.get(n),n===this._indexWithLazyExtent?(p.knowsHeight()&&this._boundEagerRange(n+1),p.reset(o.getExtent()).rebit(k)):!p.knowsElevation()&&p.reset(o.getExtent()).rebit(k)):n===1+this._indexWithLazyExtent&&this._boundEagerRange(n))},f.prototype._boundEagerRange=function(n){this._indexWithLazyExtent=n},f.prototype._lowerBoundEagerRange=function(n){n<this._indexWithLazyExtent&&this._boundEagerRange(n)},f.prototype._makeLazy=function(n,o){this._lowerBoundEagerRange(n),this._elevate(n,o)},f.prototype._makeEager=function(n,o,p){var q=this._indexWithLazyExtent,r=n+o,s=this._items.length(),t=l,u=0,v=1;if(q<n&&(q=n,v=0),r>s&&(r=s),q<r&&(0<q&&(t=this._items.get(q-1)),t.knowsExtent())){for(u=+t.getExtent()||0,q;q<r;q++)if(this._segment(q),t=this._items.get(q),t.reset(u).rebit(k),t.knowsHeight())u+=+t.getHeight()||0;else if(p)u+=this._lazyHeight(t,q);else break;v&&this._boundEagerRange(q)}},f.prototype.calculateOverflow=function(n,o){var p=(0|n)+(0|o)-this._items.length();return 0>p?0:p},f.prototype.addHeights=function(n,o,p){var q=0|n,r=0|o,s=q,t=q+r,u=0;if(this._fill(q-1),this._items.add(q,r)){for(this._lowerBoundEagerRange(q),s;s<t;s++)this._items.set(s,m),this._segment(s);for(s=0,t=0|(Array.isArray(p)&&p.length),s;s<t;s++)u+=this.setHeight(q+s,+p[s]||0)}return u},f.prototype.removeHeights=function(n,o){var p=0|n,q=0|o,r=p,s=p+q-this.calculateOverflow(p,q),t=0;for(r;r<s;r++)t+=this._items.get(r).getHeight();return this._items.remove(p,q)&&this._lowerBoundEagerRange(p),t},f.prototype.adjustHeight=function(n,o){var p=+o||0,q=0|n;this._fill(q);var r=this._items.get(q),s=p+this._lazyHeight(r,q);return p&&this.setHeight(q,s),s},f.prototype.setHeight=function(n,o){var p=+o||0,q=0|n;this._fill(q);var r=this._items.get(q),s=p-this._lazyHeight(r,q);return r.reset(r.getElevation(),p).rebit(j),s&&this._makeLazy(q+1,r),s},f.prototype.getHeight=function(n){var o=0|n;this._fill(o);var p=this._items.get(o),q=this._lazyHeight(p,o);return this._makeEager(o-1,3,0),q},f.prototype.getElevation=function(n){var o=0|n,p=o-1;this._fill(p);var q=g.call(this,p);return q||(q=0>p?l:this._items.get(p),this._makeEager(0,o,1)),this._elevate(o,q),+q.getExtent()||0},f.prototype.isElevationKnown=function(n){return 0|!!g.call(this,(0|n)-1)},f.prototype.isHeightKnown=function(n){var o=0|n,p=o<this._items.length()?this._items.get(o):null;return 0|!!(p&&p.knowsHeight())},f.prototype.areHeightsKnown=function(n,o){var p=0|n,q=0|o,r=p,s=p+q-this.calculateOverflow(p,q),t=0;for(r;r<s;r++)this._items.get(r).knowsHeight()&&t++;return t},f.prototype.terminate=function(n){var o=0|n,p=this._items.length();return p>o?(this._items.useSlice(0,o),this._lowerBoundEagerRange(o),1):0|p===o},a.Continuum=f})(window);</script><script language="javascript">(function(a){function b(y,z,A,B){this._placement=0,this._dimension=0,this._paddingAbove=0,this._paddingBelow=0,this._orientation=0,this.reposition(+y||0),this.resize(+z||0),this.repad(+A||0,+B||0)}function c(y,z){this._innerIndex=0|y,this._outerIndex=0|z}function d(y,z,A){this._continuum=y||null,this._getFirstUnavailableIndex=null,this._getFirstUnavailableIndex="function"==typeof z?z:function(){return-1},this._notifyIndex=null,this._notifyIndex="function"==typeof A?A:function(){}}function e(y,z){this._index=0|y,this._range=0|z}function f(y,z){return new e(y,z)}function g(){this._handled=v.prototype.provide(),this._handled.addHead().body=f(0,0)}function h(y,z){return new c(y,z)}function i(){var y=h(0,-1);this._placeholders=null,this._placeholders=new Snake(null,null),this._placeholders.addHead().body=y,this._available=u.prototype.provide()}function j(y,z,A,B){this._index=-1,this._height=0,this._delta=0,this._spliced=0,this._continuumInterface=null,this._continuumInterface=y,this._fence=null,this._fence=z,this._solver=null,this._solver=A,this._recycler=null,this._recycler=B}function k(y){return new Continuum(y)}function l(y,z,A,B){var C=this,D=("function"==typeof B?B:k)(function(E){return y.call(C,E,C)});this._fence=new b(0,0,0,0),this._continuumInterface=null,this._continuumInterface=new d(D,z,A),this._solver=new i,this._transactor=new j(this._continuumInterface,this._fence,this._solver,this),this._process()}function m(y,z,A){var B=this;B.adjustHeightAtIndex(z,A)}function n(y,z,A){var B=this;B.assignHeightAtIndex(z,A)}function o(y,z,A,B,C){var D=0;A[B]=A[C],A[C]=-1,D=y[B],y[B]=y[C],y[C]=D,D=z[y[B]],z[y[B]]=z[y[C]],z[y[C]]=D}function q(y,z,A,B,C,D){var E=-1-C,F=-1;for(F=0;F<B;F++)A[F]>D-1&&A[F]++;return F=B,y[F]=E,z[E]=F,A[F]=D,F}function r(y,z,A,B,C,D){var E=-1,F=0;for(F;F<B;F++)A[F]>D-1&&D===A[F]--&&(E=F);return o(y,z,A,E,B-1),E}function s(y,z,A,B,C,D,E){var F=0|C,G=B,H=z.length;if(0>E){for(;H<F;)z[H++]=-1;z[F]=G,y[G]=F}else if(G=z[F],0>D&&G!==B-1)return o(y,z,A,G,B-1),G;return A[G]=D,G}function t(y,z,A,B){var C=[],D=[],E=[],F=0;// sparse values indexed by clustered values
// clustered values indexed by sparse values
// stores the contiguous "old" position that should be passed to the handler
// the number of contiguous indices in use
l.call(this,y,z,function(G,H,I,J){var K=-1;0|(0|0>G)?0>I?(K=q(C,D,E,F,G,H),F++,A.call(this,-1-K,H,I,J)):0>H&&(K=r(C,D,E,F,G,I),F--,A.call(this,-1-K,H,I,J)):(K=s(C,D,E,F,G,H,I),0>I?F++:0>H&&F--,0>K?(K=-1-K,A.call(this,F,H,E[K],J),A.call(this,K,E[K],I,J)):A.call(this,K,H,I,J))},B)}b.prototype.isReversed=function(){return 0|!!this._orientation},b.prototype.flipOrientation=function(){var y=this._paddingAbove;return this._paddingAbove=this._paddingBelow,this._paddingBelow=y,this._orientation=0|!this._orientation},b.prototype.getAbove=function(){return this._paddingAbove},b.prototype.getBelow=function(){return this._paddingBelow},b.prototype.getPlacement=function(){return this._placement},b.prototype.getDimension=function(){return this._dimension},b.prototype.getLower=function(){return this._placement-this._paddingBelow},b.prototype.getUpper=function(){return this._placement+this._dimension+this._paddingAbove},b.prototype.reposition=function(y){return this.translate((+y||0)-(+this._placement||0))},b.prototype.translate=function(y){var z=+y||0;return z?(this._placement=(+this._placement||0)+z,0>z^this._orientation&&this.flipOrientation(),1):0},b.prototype.resize=function(y){var z=+y||0;return this._dimension===z?0:(this._dimension=z,1)},b.prototype.adjust=function(y){return this.resize((+this._dimension||0)+(+y||0))},b.prototype.repad=function(y,z){return 0|this._orientation?this._insolate(z,y):this._insolate(y,z)},b.prototype._insolate=function(y,z){var A=+y||0,B=+z||0,C=0;switch(arguments.length){default:case 2:C=C||this._paddingBelow!==B,this._paddingBelow=B;case 1:C=C||this._paddingAbove!==A,this._paddingAbove=A;case 0:}return 0|!!C},c.prototype.getInnerIndex=function(){return this._innerIndex},c.prototype.getOuterIndex=function(){return this._outerIndex},c.prototype.setOuterIndex=function(y){var z=this._outerIndex;return this._outerIndex=0|y,z},c.prototype.deltaOuterIndex=function(y){return this.setOuterIndex(this._outerIndex+(0|y));// spliceIn
},d.prototype.notify=function(y,z,A,B){this._notifyIndex.call(B,y,z,A,B)},d.prototype.getContinuum=function(){return this._continuum},d.prototype.trim=function(y){return this._continuum.terminate(y)},d.prototype.getIndexAtElevation=function(y,z,A){var B=this._continuum,C=0|B.getDiscreteCount(),D=+B.getElevation(C)||0;return y>D?this._getUnknownIndexAtElevation(y,B,C,z,A):0>y?-1:this._getKnownIndexAtElevation(y,B,C,0,A)},d.prototype._getKnownIndexAtElevation=function(y,z,A,B,C){var D=0,E=0,F=B,G=A,H=A;for(H;H;H--)if(E=F+G>>1,D=+z.getElevation(E)||0,y<D){if(G===F)break;G=E}else if(E>F)F=E;else return C&&y===D?E-1:E;return-1},d.prototype._getUnknownIndexAtElevation=function(y,z,A,B,C){var D=0,E=1,F=A,G=F,H=G;do{if(G=H,H+=E,F=0|this._getFirstUnavailableIndex.call(null,H,G+1,B),!(-1<F&&H>F))E=E<<1>>>0;else if(H=F,H>G)E=1;else{H=G,E=0;break}if(D=+z.getElevation(H)||0,y>D)continue;break}while(E);return E?this._getKnownIndexAtElevation(y,z,H,G,C):-1-A},d.prototype.getDiscreteCount=function(){var y=this.getContinuum();return y.getDiscreteCount.apply(y,arguments)},d.prototype.adjustHeight=function(){var y=this.getContinuum();return y.adjustHeight.apply(y,arguments)},d.prototype.setHeight=function(){var y=this.getContinuum();return y.setHeight.apply(y,arguments)},d.prototype.getHeight=function(){var y=this.getContinuum();return y.getHeight.apply(y,arguments)},d.prototype.getElevation=function(){var y=this.getContinuum();return y.getElevation.apply(y,arguments)},d.prototype.isElevationKnown=function(){var y=this.getContinuum();return y.isElevationKnown.apply(y,arguments)},d.prototype.isHeightKnown=function(){var y=this.getContinuum();return y.isHeightKnown.apply(y,arguments)},d.prototype.addHeights=function(){var y=this.getContinuum();return y.addHeights.apply(y,arguments)},d.prototype.removeHeights=function(){var y=this.getContinuum();return y.removeHeights.apply(y,arguments)},d.prototype.calculateOverflow=function(){var y=this.getContinuum();return y.calculateOverflow.apply(y,arguments)};var u=Snake.prototype.implementationFactory(),v=Snake.prototype.implementationFactory();e.prototype.getIndex=function(){return this._index},e.prototype.getRange=function(){return this._range},e.prototype.setRange=function(y){this._range=0|y},e.prototype.contains=function(y){var z=0|y;return 0|(z<this._index+this._range&&z>this._index-1)},e.prototype.begin=function(y){var z=0|y;return this.contains(z)?1:z==this._index-1?(this._index--,this._range++,1):0},e.prototype.end=function(y){var z=0|y;return this.contains(z)?1:z===this._index+this._range?(this._range++,1):0},g.prototype.untrackAll=function(){this._handled=v.prototype.provide(),this._handled.addHead().body=f(0,0)},g.prototype.track=function(y){var z=this._handled,A=this._greatestNotOverHandled(y,z),B=A?A.getTail(0):z.getHead(0);A&&A.body.end(y)?B&&B.body.begin(y)&&(A.body.setRange(B.body.getRange()+B.body.getIndex()-A.body.getIndex()),B.dropAnyway(1)):(!B||!B.body.begin(y))&&(A?A.addTail().body=f(y,1):z.addHead().body=f(y,1))},g.prototype._greatestNotOverHandled=function(y,z){for(var A=z.getHead(0),B=A.body,C=B.getIndex(),D=B.getRange()+C,E=null;D<y&&(E=A,A=A.getTail(0),!!A);)B=A.body,C=B.getIndex(),D=B.getRange()+C;return E},g.prototype.wasTracked=function(y){var z=0|y,A=this._greatestNotOverHandled(z,this._handled);return 0|(A&&A.body.contains(z))},i.prototype.solve=function(y,z,A,B,C,D,E){var F=this._placeholders,G=this._available,H=1+D-C,I=A-C,J=B-D,K=J-I,L=0;!y&&0>K&&(L=K,K=0),0<I?0<J?0<K?(H>I?this._windUp(z,F,I,E):H&&this._jump(z,F,A,H,E),!y&&this._pushUp(z,F,K,G,E)):(0>K&&(this._cutUp(z,F,-K,G,E),H+=K),H>J?this._windUp(z,F,J,E):H&&this._jump(z,F,A+L,H,E)):0>K&&(this._cutUp(z,F,-J,G,E),this._cutDown(z,F,I,G,E)):0>J?0<K?(H>-J?this._windDown(z,F,-J,E):H&&this._jump(z,F,A,H,E),!y&&this._pushDown(z,F,K,G,E)):(0>K&&(this._cutDown(z,F,-K,G,E),H+=K),H>-I?this._windDown(z,F,-I,E):H&&this._jump(z,F,A,H,E)):0<K&&!y&&(this._pushUp(z,F,J,G,E),this._pushDown(z,F,-I,G,E))},i.prototype._claimAvailable=function(y,z){var A=z.getTail();return A?(A.dropAnyway(1),A.body):y.getCount()},i.prototype._abandonAvailable=function(y,z){z.addTail().body=y},i.prototype._cutUp=function(y,z,A,B,C){for(var D=0|A,E=0,F=z.getHead(0),G=F.body;0<D--;)G=F.body,E=G.getInnerIndex(),F=F.dropTailwise(1),this._abandonAvailable(E,B),y.notify(E,-1,G.getOuterIndex(),C)},i.prototype._cutDown=function(y,z,A,B,C){for(var D=0|A,E=0,F=z.getTail(),G=F.body;0<D--;)G=F.body,E=G.getInnerIndex(),F=F.dropHeadwise(1),this._abandonAvailable(E,B),y.notify(E,-1,G.getOuterIndex(),C)},i.prototype._pushUp=function(y,z,A,B,C){for(var D=z.getTail(),E=D?D.body.getOuterIndex():-1,F=0,G=0|A;0<G--;)F=this._claimAvailable(z,B),z.addTail().body=h(F,++E),y.notify(F,E,-1,C)},i.prototype._pushDown=function(y,z,A,B,C){for(var D=z.getHead(0),E=D?D.body.getOuterIndex():-1,F=0,G=0|A;0<G--;)F=this._claimAvailable(z,B),z.addHead().body=h(F,--E),y.notify(F,E,-1,C)},i.prototype._windUp=function(y,z,A,B){for(var C=null,D=z.getHead(0),E=z.getTail(),F=0,G=E.body.getOuterIndex(),H=0|A;0<H--;)C=D.body,F=C.getOuterIndex(),C.setOuterIndex(++G),E=D.dropTailwise(1),z.addTail(D),D=E,y.notify(C.getInnerIndex(),G,F,B)},i.prototype._windDown=function(y,z,A,B){for(var C=null,D=z.getTail(),E=z.getHead(0),F=0,G=E.body.getOuterIndex(),H=0|A;0<H--;)C=D.body,F=C.getOuterIndex(),C.setOuterIndex(--G),E=D.dropHeadwise(1),z.addHead(D),D=E,y.notify(C.getInnerIndex(),G,F,B)},i.prototype._jump=function(y,z,A,B,C){var D=z.getHead(0),E=D.body,F=E.getOuterIndex();E.setOuterIndex(A),D.dropTailwise(1),z.addTail(D),y.notify(E.getInnerIndex(),0|A,F,C),this._windUp(y,z,(0|B)-1,C)},i.prototype.getLowestIndex=function(){var y=this._placeholders.getHead(0);return y?y.body.getOuterIndex():-1},i.prototype.getHighestIndex=function(){var y=this._placeholders.getTail();return y?y.body.getOuterIndex():-2},i.prototype._snakeWithOuterGreaterThanOrEqualToIndex=function(y){for(var z=this._placeholders.getHead(0);z&&(0|y)>z.body.getOuterIndex();)z=z.getTail();return z},i.prototype.propagateHeightChangeAtIndex=function(y,z,A){for(var B=this._snakeWithOuterGreaterThanOrEqualToIndex(0|y),C=0;B;)C=B.body.getOuterIndex(),z.notify(B.body.getInnerIndex(),C,C,A),B=B.getTail()},i.prototype.spliceOut=function(y,z,A){var B=this._snakeWithOuterGreaterThanOrEqualToIndex(y),C=0,D=(0|this._placeholders.getCount())-1;if(B&&B.body.getOuterIndex()===y){if(C=B.body.getInnerIndex(),B=B.dropTailwise(1),this._abandonAvailable(C,this._available),B!==this._placeholders)for(;B;)D--,B.body.deltaOuterIndex(-1),B=B.getTail();z.notify(-1-C,-1-D,y,A)}},i.prototype.spliceIn=function(y,z,A){var B=this._snakeWithOuterGreaterThanOrEqualToIndex(y),C=0,D=0|this._placeholders.getCount();if(B&&B.body.getOuterIndex()===y){for(C=this._claimAvailable(this._placeholders,this._available),B.addHead().body=h(C,y);B;)D--,B.body.deltaOuterIndex(1),B=B.getTail();z.notify(-1-C,y,-1-D,A)}},j.prototype.getHeight=function(){return this._height},j.prototype.setHeight=function(y){this._height=y},j.prototype.getDelta=function(){return this._delta},j.prototype.setDelta=function(y){this._delta=y},j.prototype.getCandidate=function(){return this._index},j.prototype._resetCandidate=function(){this._index=-1},j.prototype._considerCandidate=function(y,z){z&&(0>this._index||this._index>y)&&(this._index=y)},j.prototype._splicing=function(y){var z=0|this._spliced;return this._spliced=0|y,z},j.prototype.addHeightsAtIndex=function(y,z){var A=this._continuumInterface,B=A.addHeights.apply(A,arguments),C=0;if(0|z)for(this._splicing(1),C;C<z;C++)this._solver.spliceIn(y+C,A,this._recycler);this._considerCandidate(0|y,B)},j.prototype.removeHeightsAtIndex=function(y,z){var A=this._continuumInterface,B=(0|z)-A.calculateOverflow(y,z),C=A.removeHeights.apply(A,arguments),D=z;if(B)for(this._splicing(1),D;0<D--;)this._solver.spliceOut(y+D,A,this._recycler);this._considerCandidate(0|y,C)},j.prototype.assignHeightAtIndex=function(y,z){var A=this._continuumInterface,B=A.setHeight.apply(A,arguments);this.setHeight(+z||0),this.setDelta(+B||0),this._considerCandidate(0|y,+B||0)},j.prototype.adjustHeightAtIndex=function(y,z){var A=this._continuumInterface,B=A.adjustHeight.apply(A,arguments);this.setHeight(+B||0),this.setDelta(+z||0),this._considerCandidate(0|y,+z||0)},j.prototype.repositionFrame=function(){this._fence.reposition.apply(this._fence,arguments)},j.prototype.translateFrame=function(){this._fence.translate.apply(this._fence,arguments)},j.prototype.resizeFrame=function(){this._fence.resize.apply(this._fence,arguments)},j.prototype.adjustFrame=function(){this._fence.adjust.apply(this._fence,arguments)},j.prototype.repadFrame=function(){this._fence.repad.apply(this._fence,arguments)},j.prototype.setFrame=function(y,z,A,B){this.repositionFrame(y),this.resizeFrame(z),this.repadFrame(A,B)};var w=0,x=1;l.prototype.cull=function(){this._process(x)},l.prototype.truncate=function(y){var z=this._continuumInterface,A=0|z.getDiscreteCount(),B=0|y,C=0|A>B;return(!arguments.length||0>B)&&(B=z.getIndexAtElevation(this.getFrameUpperBound(),this,1),0>B?B=-B-1:B+=1,C=0|A>B),C?(this._migrate(B),z.trim(B),1):0},l.prototype._migrate=function(y){var z=this._fence,A=this._continuumInterface,B=this.getLowestIndex(),C=this.getHighestIndex(),D=1+C,E=D-B,F=y-E,G=F-1,H=this._solver,I=0,J=0,K=0,L=0;if(0>F)F=0,G=y-1,y&&(L=A.getElevation(y),J=z.getAbove(),L-=J,0>L?(J+=L,L=0):(K=z.getBelow(),L-=K,0>L?(K+=L,L=0):I=L)),z.reposition(0),z.resize(I),z.repad(J,K);else if(D>y)G=E-1,z.reposition(A.getElevation(F)+z.getBelow());else return 0;return H.solve(x,A,F,G,B,C,this),1},l.prototype.getLowestIndex=function(){return this._solver.getLowestIndex()},l.prototype.getHighestIndex=function(){return this._solver.getHighestIndex()},l.prototype.transactHeightMutations=function(y){var z=this._transactor,A=-1;z._resetCandidate(),y.apply(z,arguments),A=z.getCandidate(),-1<A&&(0|z._splicing(0),this._solver.propagateHeightChangeAtIndex(A,this._continuumInterface,this),this._process(w))},l.prototype.adjustHeightAtIndex=function(y,z){return this.transactHeightMutations(m,y,z),this._transactor.getHeight()},l.prototype.setHeightAtIndex=function(y,z){return this.transactHeightMutations(n,y,z),this._transactor.getDelta()},l.prototype.getHeightAtIndex=function(){return this._continuumInterface.getHeight.apply(this._continuumInterface,arguments)},l.prototype.getElevationAtIndex=function(){return this._continuumInterface.getElevation.apply(this._continuumInterface,arguments)},l.prototype.isElevationKnownAtIndex=function(){return this._continuumInterface.isElevationKnown.apply(this._continuumInterface,arguments)},l.prototype.isHeightKnownAtIndex=function(){return this._continuumInterface.isHeightKnown.apply(this._continuumInterface,arguments)},l.prototype.getConcreteCount=function(){return this._continuumInterface.getDiscreteCount()},l.prototype.getFramePlacement=function(){return this._fence.getPlacement()},l.prototype.getFrameDimension=function(){return this._fence.getDimension()},l.prototype.getFrameLowerBound=function(){return this._fence.getLower()},l.prototype.getFrameUpperBound=function(){return this._fence.getUpper()},l.prototype.repositionFrame=function(){return this._fence.reposition.apply(this._fence,arguments)&&this._process(w),this},l.prototype.translateFrame=function(){return this._fence.translate.apply(this._fence,arguments)&&this._process(w),this},l.prototype.resizeFrame=function(){return this._fence.resize.apply(this._fence,arguments)&&this._process(w),this},l.prototype.adjustFrame=function(){return this._fence.adjust.apply(this._fence,arguments)&&this._process(w),this},l.prototype.repadFrame=function(){return this._fence.repad.apply(this._fence,arguments)&&this._process(w),this},l.prototype.setFrame=function(y,z,A,B){var C=this._fence,D=0;return D=C.reposition(y)||D,D=C.resize(z)||D,D=C.repad(A,B)||D,D&&this._process(w),this},l.prototype._process=function(y){var z=this._fence,A=this._continuumInterface,B=+z.getLower()||0,C=+z.getUpper()||0,D=!0,E=0|A.getIndexAtElevation(B,this,0|!D),F=0|A.getIndexAtElevation(C,this,0|D),G=this.getLowestIndex(),H=this.getHighestIndex(),I=this._solver,J=0;return 0>E&&0>F&&(J=A.getElevation(A.getDiscreteCount()),B>J?(B-=C-J,C=J,J=-1):0>C&&(C-=B,B=0,J=-1),0>J&&(E=0|A.getIndexAtElevation(B,this,0|!D),F=0|A.getIndexAtElevation(C,this,0|D))),0>E&&(E=0),0>F&&(F=-1+(0|A.getDiscreteCount())),I.solve(y,A,E,F,G,H,this)},t.prototype=new l(function(){return 44},function(){return-1},function(){},null),t.prototype.SparseRecycler=l,a.Recycler=t})(window);</script><script>(function(a){a.Resolvable={ready:function(){this.hasAttribute('unresolved')&&this.removeAttribute('unresolved')}}})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(a){var b=a.MixinFindable={properties:{mixinFindable:{type:Object,value:function(){return this},notify:!0}},mixinsForValue:function(){return null;// override
},mixinsForValuePath:function(){return null;// override
},prototypeAsMixin:function(c){var d={};for(var e in Array.isArray(c.behaviors)&&0>c.behaviors.indexOf(b)?c.behaviors.push(b):!c.behaviors&&(c.behaviors=[b]),c)d[e]=c[e];return c.mixinsForValue=function(){return d},c}}})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(a){a.TemplateFindable={properties:{_templateFound:{type:Object,computed:"_computeTemplate(templateFinder, templateFinder.template)"},templateFinder:{type:Object,notify:!0},templateFindable:{type:Object,value:function(){return this},notify:!0},templatePriority:{type:Array,value:function(){return["lightdom","import","bind"]},notify:!0},templateBind:{type:Object,value:null,notify:!0},templateMatch:{type:String,value:"template:not([is])",// use <template preserve-content></template> in certain cases
notify:!0},templateSelector:{type:String,value:"",notify:!0},templateUri:{type:String,notify:!0},templateQuery:{type:String,value:"template:not([is])",notify:!0}},ready:function(){this.notifyPath("templateFindable.templatePriority",this.templatePriority),this.notifyPath("templateFindable.templateBind",this.templateBind),this.notifyPath("templateFindable.templateMatch",this.templateMatch),this.notifyPath("templateFindable.templateSelector",this.templateSelector),this.notifyPath("templateFindable.templateUri",this.templateUri),this.notifyPath("templateFindable.templateQuery",this.templateQuery)},_computeTemplate:function(b,c){return c},_computeTemplateContents:function(b,c){return c},hasTemplate:function(){return 0|!!this._templateFound}}})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(a){var b={properties:{ref:{type:Object,notify:!0,readOnly:!0,value:function(){return this}}},findById:function(c){return this.$[c]||this.$$('#'+c)}};a.Refable=b})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(c){// https://gist.github.com/jed/982883/b64ba1ce6e0d5793473766f55f5422e620e4430e
function d(p,q){var s=-1,t=-1,u="";return p&&(s=m.indexOf(p),0>s?(s=-1+m.push(p),u=p.innerHTML,t=l.indexOf(u),0>t&&(t=-1+l.push(u),k.push(i(u,t,q,p))),n.push(t)):t=n[s]),0>t?null:k[t]}function e(){var p="";do p=o();while(j[p]);return j[p]=1,p}function f(p){return Array.isArray(p)?p:[p]}function g(){var p=this,q=this,s=arguments.length,t=0,u=null;for(t;t<s;t++)for(var v in q=arguments[t],q)u=h.call(p,v),u?Object.defineProperty(p,v,u):p[v]=q[v];return p}function h(p){var q=this,s=null;do s=Object.getOwnPropertyDescriptor(q,p)||null;while(!s&&(q=Object.getPrototypeOf(q)));return s}function i(p,q,s,t){function u(F,G){var H=this[G];H&&H.innerHTML!==F.innerHTML&&(F.innerHTML=H.innerHTML)}function v(F){var G=Polymer.StyleUtil.rulesForStyle(F);G.rules=G.rules.reduce(function(H,I){var J=I.selector,K=J.indexOf(":host"),L=J.indexOf("::content");return 0>K?(I.selector=":host ::content "+I.selector,H.push(I)):L>K&&(I.selector=J.slice(L+"::content".length),H.push(I)),H},[]),F.textContent+="\n\n"+Polymer.StyleUtil.toCssText(G,null,1)}function w(){if(!this[A]._childNodes){// take all the elements in the shadow dom, and add them to the light dom
// (except the terminating <content></content> element)
var F=Polymer.dom(this),G=Polymer.dom(this.root),H=G.querySelector("content#"+z),I=G.querySelectorAll("style:not([is])"),J=I.length,K=0;for(G.appendChild(H),K;K<J;K++)G.appendChild(I[K]);var L=Array.apply(null,G.childNodes);for(J=L.length,K=0,K;K<J&&L[K]!==H;K++);for(L=L.slice(0,K),J=L.length,K=0,K;K<J;K++)F.appendChild(L[K]);this[A]._childNodes=L}}function x(){if(Polymer.Settings.useNativeShadow)return 1;if(this[A]._correctedStyleScopes)return 1;// fix for dom-repeat styling in shady-dom
var F=Polymer.dom(this),G=F.getOwnerRoot(),H=G&&G.host||null;if(!H){if(H=F.parentNode,!H)return 0;Polymer.StyleTransformer.dom(this,H.is)}var I=F.querySelectorAll("*"),J=I.length,K=0;for(K;K<J;K++)Polymer.StyleTransformer.dom(I[K],this.is,void 0,!0),Polymer.StyleTransformer.dom(I[K],H.is);return this[A]._correctedStyleScopes=1}var y=e(),z="strand-gen-comp-n"+q+"-x"+y.split("-").join(""),A="__mmgencompn"+q+"x"+y.slice(0,8),B=document.createElement("dom-module"),C=document.createElement("template");C.innerHTML=p+"<content id=\""+z+"\"></content>",function(G){var H=G.querySelectorAll("style:not([is])"),I=H.length,J=0;for(J;J<I;J++)v(H[J])}(C.content);// for Safari 8
var D=null;B.appendChild(C),B.register(z);var E={};return function(F){F&&g.apply(E,f(F))}(s?s.mixinsForValue&&s.mixinsForValue(t)||s.mixinsForValuePath&&s.mixinsForValuePath(t,[]):null),E.is=z,E.extends="div",E.behaviors=[],function(F){F&&E.behaviors.push.apply(E.behaviors,f(F))}(s&&s.mixinsForValuePath?s.mixinsForValuePath(t,["behaviors"]):null),E.behaviors.push(StrandTraits.Refable),E.properties={},function(F){F&&g.apply(E.properties,f(F))}(s&&s.mixinsForValuePath?s.mixinsForValuePath(t,["properties"]):null),E.properties.model={type:Object,value:null,notify:!0},E.properties.scope={type:Object,value:null,notify:!0},E.properties.index={type:Number,value:-1,notify:!0},E.properties.key={type:String,value:"",notify:!0},E.properties[A]={type:Object,readOnly:!0,value:function(){var F={};return F._childNodes=null,F._correctedStyleScopes=0,F}},E.instanceTemplate=function(F){var G=CustomElements.useNative?document.importNode(F.content,!0):document.adoptNode(F.content.cloneNode(!0));// the above does not work in Safari 8 without the following fix applied
return G},E.attached=function(){this.preferLightDom&&w.call(this),this[A]._childNodes&&this.async(x,0)},E.ready=function(){this.preferLightDom&&w.call(this)},E.useLightDom=function(){this.preferLightDom=!0,w.call(this),this.async(x,0)},Polymer(E)}var j=Object.create(null),k=[],l=[],m=[],n=[],o=function p(q){return q?(q^16*Math.random()>>q/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,p)};c.TemplateComponentizable={instantiateTemplate:function(p,q,s){var t=s?s.mixinFindable:null,u=p&&d(p,t)||null,v=u?new u:null;return q&&v&&v.useLightDom(),v}}})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(a){var b=document.attachEvent;if(!b){var c=function(){var s=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};return function(t){return s(t)}}(),d=function(){var s=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return s(t)}}(),f=function(t){if(t.__resizeTriggers__){// diverges from 3d9563692e169eb54f7c4fb96f4866aebc17cb4e
var u=t.__resizeTriggers__,v=u.firstElementChild,w=u.lastElementChild,x=v.firstElementChild;w.scrollLeft=w.scrollWidth,w.scrollTop=w.scrollHeight,x.style.width=v.offsetWidth+1+'px',x.style.height=v.offsetHeight+1+'px',v.scrollLeft=v.scrollWidth,v.scrollTop=v.scrollHeight}},g=function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height},h=function(t){var u=this;f(this),this.__resizeRAF__&&d(this.__resizeRAF__),this.__resizeRAF__=c(function(){g(u)&&(u.__resizeLast__.width=u.offsetWidth,u.__resizeLast__.height=u.offsetHeight,u.__resizeListeners__.forEach(function(v){v.call(u,t)}))})},j=!1,k='',l='animationstart',m='Webkit Moz O ms'.split(' '),n='webkitAnimationStart animationstart oAnimationStart MSAnimationStart'.split(' '),o='';/* Detect CSS Animations support to detect element display/re-attach */{var p=document.createElement('fakeelement');if(void 0!==p.style.animationName&&(j=!0),!1==j)for(var q=0;q<m.length;q++)if(void 0!==p.style[m[q]+'AnimationName']){o=m[q],k='-'+o.toLowerCase()+'-',l=n[q],j=!0;break}}var r='resizeanim'}a.SizeResponsible={properties:{_alias:{type:Object,value:function(){return this}}},addResizeListener:function(s,t){var u=t||this,v=' '+this.tagName.toLocaleLowerCase()+' ';b?u.attachEvent('onresize',s):(!u.__resizeTriggers__&&('static'==getComputedStyle(u).position&&(u.style.position='relative'),u.__resizeLast__={},u.__resizeListeners__=[],u.__resizeTriggers__=document.createElement('div'),u.__resizeTriggers__.className='resize-triggers'+v,u.__resizeTriggers__.innerHTML='<div class="expand-trigger'+v+'"><div></div></div><div class="contract-trigger'+v+'"></div>',Polymer.dom(u).appendChild(u.__resizeTriggers__),f(u),u.addEventListener('scroll',h,!0),l&&u.__resizeTriggers__.addEventListener(l,function(w){w.animationName==r&&f(u)})),u.__resizeListeners__.push(s))},removeResizeListener:function(s,t){var u=t||this;b?u.detachEvent('onresize',s):u.__resizeListeners__&&(u.__resizeListeners__.splice(u.__resizeListeners__.indexOf(s),1),!u.__resizeListeners__.length&&(u.removeEventListener('scroll',h),u.__resizeTriggers__=!Polymer.dom(u).removeChild(u.__resizeTriggers__)))}}})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(a){function b(g){f.add(g)}function c(g){f.delete(g)}function d(g){g.resize&&g.resize()}function e(g){g.scroll&&g.scroll()}var f=new Set;window.addEventListener("resize",function(){f.forEach(d)}),window.addEventListener("scroll",function(){f.forEach(e)},!0),a.WindowNotifier={attached:function(){b(this)},detached:function(){c(this)},resize:function(){//behavior stub
},scroll:function(){//behavior stub
}}})(window.StrandTraits=window.StrandTraits||{});</script><script>(function(a){function b(f){var g;return f&&Array.isArray(f.volume)?(g=f.volume,f.volume=[],f.filled=0,g):null}function c(f,g){var h=0;return f&&Array.isArray(f.volume)?(h=0|f.filled,f.volume[h]=g,f.filled=1+h,1):0}function d(f,g){var h=0,i;return f&&Array.isArray(f.volume)?(h=-1+(0|f.filled),-1<h&&h<f.volume.length?(i=f.volume[h],f.volume[h]=null,f.filled=h,i):g):g}var e=function(){this.filled=0,this.volume=[]};a.PoolUsable={properties:{// _globalPool: reservedProperty,
_localPool:{type:Object,value:function(){return new e}}},registered:function(){var f=this;f.properties=f.properties||{},f.properties.hasOwnProperty("_globalPool")?console.warn("_globalPool propery not assigned by StrandTraits.PoolUsable because it already exists"):f.properties._globalPool={type:Object,value:new e}},poolDemand:function(f){var g=d(this._localPool,f);return g===f&&(g=d(this._globalPool,f)),g},poolSupply:function(f){return c(this._localPool,f)},poolDrainLocal:function(f){var g=b(this._localPool),h=0|(g&&g.length),i=0;if(f)for(i;i<h;i++)c(this._globalPool,g[i]);return 0|!!g},poolDrainGlobal:function(){var f=b(this._globalPool);return 0|!!f}}})(window.StrandTraits=window.StrandTraits||{});</script><link rel="import" href="../strand-template-finder/strand-template-finder.html"></div><dom-module id="strand-item-recycler"><template><style>#overlay,#quad{position:absolute}@keyframes resizeanim{from,to{opacity:0}}.resize-triggers{animation:1ms resizeanim;visibility:hidden;opacity:0}.contract-trigger:before,.resize-triggers,.resize-triggers>div{content:" ";display:block;position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}#overlay,#overlay #fixes-flicker{top:0;left:0;display:-ms-flexbox;pointer-events:none}.resize-triggers>div{background:#eee}.contract-trigger:before{width:200%;height:200%}#overlay,#pane,#quad{width:100%;height:100%}:host{display:block;overflow:auto;position:relative}:host([x-scroll=none]) #constrainer{max-width:100%}#pane{overflow-x:inherit;overflow-y:inherit;max-height:inherit}#quad{top:0;left:0;display:block;overflow:hidden}#overlay{display:flex}#overlay #fixes-flicker{right:0;width:100%;height:100%;display:flex}#overlay>#fixes-flicker>::content>*,#overlay>::content>*{pointer-events:all}#constrainer{display:inline-block}#constrainer,#footer,#header,#middle{min-width:100%;position:relative}.recycler-panel{position:relative}:host([measuring]) #middle{visibility:hidden}</style><strand-template-finder template-finder="{{templateFinder}}" template-findable="{{templateFindable}}"><content select="template:not([is])"></content></strand-template-finder><div id="pane"><div id="quad"></div><div id="constrainer"><div id="middle"></div><div id="header"><content select="[recycler=header]"></content></div><div id="footer"><content select="[recycler=footer]"></content></div></div></div><div id="overlay"><div id="fixes-flicker"><content select="[recycler=overlay]"></content></div></div></template></dom-module><script>(function(){function a(j){return j}function b(j,k){return j.nthDOM-k.nthDOM}function c(){var j=this,k=j.height,l=+(h(j.element)-k)||0,m=j.itemRecycler,n=0,o=!0;m&&(0<l||0>=m._itemHeight||m._itemHeight&&0>l?(j.height+=l,m._measurements.setHeight(j.young,j.height),j.height&&(m._itemHeight?0>m._itemHeight&&(n=m._accommodateGlobalHeightAdjustment(0|!o,j,l),m.async(m._modifyPadding,1)):(!k&&m._deltaMiddleHeight(-m._viewportHeight),n=m._accommodateGlobalHeightAdjustment(0|o,j,l),m.async(m._modifyPadding,1),-1<m._desiredIndex&&m.async(m._scrollToIndex),m._initialized&&m._setMeasuring(!1))),m._changeOffsetsAfter(j.nthDOM,l),m._deltaMiddleHeight(m._recycler.setHeightAtIndex(j.young,j.height)),m._repositionHeader(),m._repositionFooter(),l+n&&m._paneResponse(null),m.debounce("settle-down",m._settleDown,1)):j.pendingResponse&&(m._measurements.setHeight(j.young,j.height),m.debounce("settle-down",m._settleDown,1)),0>m._itemHeight&&(m._itemHeight=-m._itemHeight),j.pendingResponse=0)}function d(j,k){this.itemRecycler=j,this.nthBind=k,this.nthDOM=-1,this.young=-1,this.height=0,this.offset=0,this.location=0,this.instance=null,this.element=null,this.value=null,this.pendingResponse=0,this.responder=c.bind(this)}function f(j,k){var l=arguments.length;this.model=0<l?j:null,this.scope=1<l?k:null}function g(){this.scroll=null,this.pane=null,this.header=null,this.footer=null}function h(j){return j.getBoundingClientRect().height;// Firefox uses doubles
// return element.offsetHeight; // only provides integers
}function i(j){return j;//return 0|value; // somewhat related to elementHeight() above
}window.addEventListener("mousewheel",Function());d.prototype=Object.create(null),f.prototype=Object.create(null),Polymer({is:"strand-item-recycler",behaviors:[StrandTraits.Resolvable,StrandTraits.WindowNotifier,StrandTraits.MixinFindable,StrandTraits.TemplateFindable,StrandTraits.TemplateComponentizable,StrandTraits.SizeResponsible,StrandTraits.Refable,StrandTraits.PoolUsable],properties:{gpu:{type:String,value:"2d"},_gpuAssignedOnce:String,xScroll:{type:String,value:"all",reflectToAttribute:!0},scope:{type:Object,value:function(){return this},notify:!0},index:{type:Number,value:0,notify:!0},_desiredIndex:{type:Number,value:-1},_bindingList:{type:Array,value:function(){return[]}},_initialized:{type:Boolean,value:!1},_initializable:{type:Boolean,value:!1},_itemHeight:{type:Number,value:0},_transformBaseline:{type:Number,value:0},_headerHeight:{type:Number,value:0},_footerHeight:{type:Number,value:0},_middleHeight:{type:Number,value:0},_viewportHeight:{type:Number,value:0},_scrollTop:{type:Number,value:0},_maxPixels:{type:Number,value:16777216},_responders:{type:Object,value:function(){var j=new g(this);return j.scroll=this._scrollHandler.bind(this),j.pane=this._paneResponse.bind(this),j.header=this._headerResponse.bind(this),j.footer=this._footerResponse.bind(this),j}},_recycler:{type:Object,value:function(){return new Recycler(this._getItemHeight.bind(this),this._getQueriableLength.bind(this),this._handleRecycling.bind(this))}},_measurements:{type:Object,value:function(){return new Continuum(this._getItemHeight.bind(this))}},measuring:{type:Boolean,value:!1,notify:!0,readOnly:!0,reflectToAttribute:!0},data:{type:Array,value:null,notify:!0}},observers:["_needsInitialization(data, _templateFound)","_scopeChanged(scope.*)","_dataChanged(data.*)","_dataSpliced(data.splices)"],_spliceTxn:function(j,k,l){var m=this,n=0|(l&&l.length),o=0,p=null,q=0,r=0,s=0,t=0;for(o;o<n;o++)p=l[o],(r=0|p.removed.length)&&(t=k._measurements.areHeightsKnown(p.index,r),s-=k._getItemHeight()*(r-t),s-=k._measurements.removeHeights(p.index,r),m.removeHeightsAtIndex(p.index,r)),(q=0|p.addedCount)&&(k._measurements.addHeights(p.index,q),k._itemHeight&&(s+=k._getItemHeight()*q),m.addHeightsAtIndex(p.index,q,k._spliceHeights(q)));k._deltaMiddleHeight(s),k._applyTransform()},_spliceHeights:function(j){var k=0|j,l=0,m=Array(k),n=this._itemHeight?this._getItemHeight():0;for(l;l<k;l++)m[l]=n;return m},_dataSpliced:function(j){var k=this._bindingList,l=-1,m=j?j.indexSplices:null,n=0|(m&&m.length),o=0,p=0,q=this._getDataLength(),r=-1,s=0,t=0;if(n){for(o;o<n;o++)t=m[o].index,s=m[o].addedCount,p+=s-m[o].removed.length,q>t&&(q=t),r<t+s&&(r=t+s-1);if(p&&(0==this.data.length-p&&this._setMeasuring(!0),this._recycler.transactHeightMutations(this._spliceTxn,this,m),this.async(this.cull)),t=this._recycler.getLowestIndex(),-1<t&&q>t&&(q=t),t=this._recycler.getHighestIndex(),-1<t&&r<t&&(r=t),!(r<q))for(s=r-q+1+p,n=k.length,o=0,o;o<n&&!((l=k[o].young,!(l<q||l>r))&&(k[o].instance.notifyPath("model",this.data[l]),k[o].instance.notifyPath("index",l),2>s--));o++);}},_dataChanged:function(j){var k="data.",l=k.length,m=j.path,n=0===m.indexOf(k),o=m.indexOf(".",l),p=NaN,q=this._bindingList,r=0|(q&&q.length),s=0,t=null,u=0,v=null;if(n&&(m.charCodeAt(l)==="#".charCodeAt(0)&&(l+=1,u=1),o<l&&(o=m.length),o>l&&(p=+m.slice(l,o)),!isNaN(p)))if(u)for(v=Polymer.Collection.get(this.data).getItem("#"+p),s;s<r;s++)t=q[s],t&&t.value&&this.data[t.young]===v&&(t.value.model=v,t.instance.notifyPath("model"+j.path.slice(o),j.value));else for(s;s<r;s++)t=q[s],t&&t.young===p&&(t.value.model=this.data[p],t.instance.notifyPath("model"+j.path.slice(o),j.value))},_scopeChanged:function(j){var k=this._bindingList,l=0|(k&&k.length),m=0,n=null;for(m=0;m<l;m++)n=k[m],n&&n.instance.notifyPath(j.path,j.value)},attached:function(){this.$.pane.addEventListener("scroll",this._responders.scroll,!0),this.addResizeListener(this._responders.pane,this.$.pane),this.addResizeListener(this._responders.header,this.$.header),this.addResizeListener(this._responders.footer,this.$.footer)},detached:function(){this.$.pane.removeEventListener("scroll",this._responders.scroll),this.removeResizeListener(this._responders.pane,this.$.pane),this.removeResizeListener(this._responders.header,this.$.header),this.removeResizeListener(this._responders.footer,this.$.footer)},_settleDown:function(){this.fire("presentation-settled")},_paneResponse:function(){var j=this,k=+(h(j.$.quad)-j._viewportHeight)||0;k-=this._headerHeight+this._footerHeight,k&&(j._viewportHeight+=k,j._initialized&&j._recycler.resizeFrame(j._viewportHeight),j._repositionFooter(),j.debounce("settle-down",j._settleDown,1))},_headerResponse:function(){var j=this,k=+(h(j.$.header)-j._headerHeight)||0;k&&(j._headerHeight+=k,j._viewportHeight-=k,j._initialized&&j._recycler.resizeFrame(j._viewportHeight),j._repositionMiddle(),j._repositionFooter(),j.debounce("settle-down",j._settleDown,1))},_footerResponse:function(){var j=this,k=+(h(j.$.footer)-j._footerHeight)||0;k&&(j._footerHeight+=k,j._viewportHeight-=k,j._initialized&&j._recycler.resizeFrame(j._viewportHeight),j._repositionFooter(),j.debounce("settle-down",j._settleDown,1))},_accommodateGlobalHeightAdjustment:function(j,k,l){var m=i(k.height+this._itemHeight),n=0;return this._itemHeight=i(k.height),j?(n=(this._getDataLength()-this._measurements.getDiscreteCount())*m,0>=this._viewportHeight&&(n-=1),this._deltaMiddleHeight(n)):(this._measurements.terminate(0),n=this._getDataLength()*k.height-l-this._middleHeight,this._deltaMiddleHeight(n),this._recycler.transactHeightMutations(this._reinitTxn,this,k)),n},_reinitTxn:function(j,k,l){var m=this,n=k._getDataLength(),o=0;for(o=0;o<n;o++)o!==l.young&&m.assignHeightAtIndex(o,k._itemHeight)},_modifyPadding:function(){var j=this._bindingList,k=j,l=0,m=0,n=null,o=0;for(0<this._itemHeight&&(this._provideMarginOfError(),this._denyMarginOfError()),k=j?j.filter(a).sort(b):null,l=0|(k&&k.length),m=0;m<l;m++)n=k[m],n&&n.offset!==o&&(n.offset=o,this._repositionBound(n)),o+=n.height},_provideMarginOfError:function(){var j=i(this._itemHeight),k=3*j;this._recycler.repadFrame(j+k,j+k)},_denyMarginOfError:function(){var j=i(this._itemHeight);this._recycler.repadFrame(j,j)},cull:function(){this._provideMarginOfError(),this._recycler.cull(),this._denyMarginOfError(),this.async(this._modifyPadding,1)},_changeOffsetsAfter:function(j,k){var l=this._bindingList,m=0|(k&&l&&l.length),n=0,o=null;for(n;n<m;n++)o=l[n],o&&o.nthDOM>j&&(o.offset+=k,this._repositionBound(o))},_needsInitialization:function(){this._initializable=!0,this._initialized=!1,this.initialize()},initialize:function(){return this.data?this.hasTemplate()?(this._setMeasuring(!0),this.debounce("initializeRecycler",this.initializeRecycler,1),1):0:0},initializeRecycler:function(){return this._initializable?(this._recycler.truncate(0)&&(this._scrollTop=0,this.$.pane.scrollTop=0,this._itemHeight=0),this._recycler.setFrame(0,0,0,0),this._measurements.terminate(0),this._initializeViewport(),this._initializable=!1,this._initialized=!0,this.data&&this.data.length||this._setMeasuring(!1),1):0},_initializeViewport:function(){var j=h(this.$.quad);this._headerHeight=h(this.$.header),this._footerHeight=h(this.$.footer),j-=this._headerHeight+this._footerHeight,this._viewportHeight=j,0<this._viewportHeight?this._assignMiddleHeight(this._viewportHeight):this._assignMiddleHeight(1),this._repositionHeader(),this._repositionFooter(),this._repositionMiddle();var k=0|this.index,l=i(this._itemHeight);this.index=0,this._recycler.setFrame(0,this._middleHeight,l,l),0>this._desiredIndex&&(this._desiredIndex=k)},_scrollToIndex:function(){this.scrollToIndex(this._desiredIndex,-1)},scrollToIndex:function(j,k){var l=+k||0,m=0|(arguments.length?j:this._desiredIndex),n=0|(this.data&&this.data.length),o=0,p=0,q=0;return this._desiredIndex=-1,-1<m&&m<n?m<this._getDataLength()?(p=this._recycler.getElevationAtIndex(m),0>l||!l&&this._scrollTop>=p?(this.$.pane.scrollTop=p,q=this._scrollTop-this.$.pane.scrollTop):(o=this._recycler.getElevationAtIndex(m+1),(0<l||this._scrollTop<o-this._viewportHeight)&&(this.$.pane.scrollTop=o-this._viewportHeight,q=this._scrollTop-this.$.pane.scrollTop)),q&&(this._desiredIndex=m),1):0:0},_determineIndex:function(){var j=this._scrollTop,k=this._recycler.getLowestIndex()+1,l=this._recycler.getHighestIndex()+1;for(k;k<l&&!(this._recycler.getElevationAtIndex(k)>j);k++);this.index=k-1},scrollBy:function(j){var k=+j||0;k&&(this._repositionHeader(),this._repositionFooter(),this._recycler.translateFrame(k)),this._determineIndex(),-1<this._desiredIndex&&this.hasMeasuredAnItem()&&this.debounce("seek",this._scrollToIndex)},_scrollResponse:function(){var j=this.$.pane.scrollTop-this._scrollTop,k=this._middleHeight-this._viewportHeight;this._scrollTop=this.$.pane.scrollTop,k<this._scrollTop&&0<k?(j-=this._scrollTop-k,this._scrollTop=k,this.scrollBy(j),this.$.pane.scrollTop=this._scrollTop):this.scrollBy(j)},_scrollHandler:function(j){j.target===this.$.pane&&(j.stopImmediatePropagation(),this.debounce("work",this._scrollResponse))},inferOffviewHeightsAfterNextMutation:function(){0<this._itemHeight&&(this._itemHeight=-this._itemHeight,this._measurements.terminate(0))},_getDataLength:function(){var j=0|(this.data&&this.data.length);return this._itemHeight?j:j?1:0},_getQueriableLength:function(){return this._getDataLength()},_getItemHeight:function(){return this._itemHeight?0>this._itemHeight?-this._itemHeight:this._itemHeight:this._viewportHeight||1},_handleRecycling:function(j,k,l,m){var n=0|j,o=0|(0|0>n),p=null,q=this._bindingList,r=0|(q&&q.length),s=0,t=0,u=1;if(o){if(0>l)p=this._includeBoundAtIndex(-1-n,k,o,u),r++;else if(0>k){for(this.debounce("offset-removal",this._modifyPadding),p=this._excludeBoundAtIndex(-1-n,l,o),p=null;0<r--&&!q[r];)q.pop();r++}else return;}else if(0>l){if(r!=n)throw new Error("Recycler constraints broken -- count !== index: "+r+" / "+n);p=this._includeBoundAtIndex(n,k,o,u),r++}else if(0>k){for(this.debounce("offset-removal",this._modifyPadding),p=this._excludeBoundAtIndex(n,l,o),p=null;0<r--&&!q[r];)q.pop();r++}else n<r&&(p=q[n]);p?((l!==k||o)&&(p.value.model=this.data[k],p.instance.set("model",p.value.model),p.instance.set("index",k)),this._measurements.isHeightKnown(k)?(t=this._measurements.getHeight(k),this.debounce(k,this._getBoundResponse(p))):(t=m.getHeightAtIndex(k),p.pendingResponse=1,this.debounce(k,this._getBoundResponse(p),0|!(0<this._itemHeight))),s=this._measurements.isElevationKnown(k)?p.location=this._measurements.getElevation(k):p.location=m.getElevationAtIndex(k),p.young=k,this._changeOffsetsAfter(p.nthDOM,t-p.height),p.height=t,p.offset=this._calculateStaticPositionOffset(p.nthDOM),s<this._maxPixels?(this._repositionBound(p),this.debounce("rebase-transform",this._rebaseTransform,250)):this._rebaseTransform()):o&&this.async(this._applyTransform),this.debounce("settle-down",this._settleDown,1)},_retrofitBound:function(j,k,l,m){j.nthDOM=k,j.value=new f(this.data[l],this.scope),j.instance=this.instantiateTemplate(this._templateFound,0|!m,this),j.instance.set("scope",this.scope),j.instance.set("model",j.value.model),j.instance.set("index",l)},_demandBound:function(){var j=this.poolDemand(null)||new d(this,-1);return j.element||(j.element=document.createElement("DIV"),this.toggleClass("recycler-panel",!0,j.element),this._addBoundResponse(j)),j.itemRecycler=this,j},_supplyBound:function(j){var k=j.element,l=k.lastChild;if(l)do"div"===l.localName&&/^strand-gen-comp-/.test(l.is)&&k.removeChild(l);while(l=l.previousElementSibling);this.value=null,j.offset=0,j.position=0,this._setTranslation(0,j.element),this.poolSupply(j)},_adjustNthDOM:function(j,k){var l=this._bindingList,m=l.length,n=0,o=null;for(n=0;n<m;n++)o=l[n],o&&o.nthDOM>(0|j)&&(o.nthDOM+=0|k)},_calculateStaticPositionOffset:function(j){var k=this._bindingList,l=k.length,m=0,n=null,o=0;for(m;m<l;m++)n=k[m],n&&n.nthDOM<j&&(o+=n.height);return o},_includeBoundAtIndex:function(j,k,l,m){var n=0|j,o=this._bindingList,p=o.length,q=this._demandBound(),r=q,s=r,t=k-1;if(l)for(n=0;n<p;n++)q=o[n],q&&q.young>t&&k===q.young++&&(s=q);else{for(n=0;n<p;n++)q=o[n],q&&(s.young>q.young||s===r)&&(s=q);0===s.nthDOM&&(s=r)}if(s===r?(s=null,t=p):t=s.nthDOM,this._adjustNthDOM(t-1,1),q=r,n=0|j,p!==n)throw new Error("Internal recycling inconsistency due to splicing");return o[n]=q,this._retrofitBound(q,t,k,m),Polymer.dom(q.element).appendChild(q.instance),s?Polymer.dom(this.$.middle).insertBefore(q.element,s.element):Polymer.dom(this.$.middle).appendChild(q.element),q},_excludeBoundAtIndex:function(j,k,l){var m=0|j,n=this._bindingList,o=n.length,p=n[m],q=p,r=o-1;if(p=n[m],n[m]=n[r],n[r]=p,n[m].nthBind=m,n[r].nthBind=r,l)for(r=k-1,m=0;m<o;m++)p=n[m],p&&p.young>r&&p.young--;return this._adjustNthDOM(q.nthDOM,-1),p=q,m=0|--o,p.nthDOM=-1,p.itemRecycler=null,Polymer.dom(Polymer.dom(p.element).parentNode).removeChild(p.element),this._supplyBound(p),n[o]=null,p},_addBoundResponse:function(j){j.nthBind;var k=j.responder;return this.addResizeListener(k,j.element),k},_getBoundResponse:function(j){return j.responder},_removeBoundResponse:function(j){j.nthBind;var k=j.responder;this.removeResizeListener(k,j.element)},_rebaseTransform:function(){var j=this._bindingList,k=j?j.reduce(this._minimumElevationReducer,this._someBoundLocation(j)):0;this._transformBaseline=k,j&&j.forEach(this._rebaseEachTransform,this),this._applyTransform()},_someBoundLocation:function(j){var k=j.length,l=0,m=null,n=0;for(l;l<k;l++)if(m=j[l]){n=m.location;break}return n},_minimumElevationReducer:function(j,k){return!k||j<k.location?j:k.location},_rebaseEachTransform:function(j){j&&this._repositionBound(j)},_gpu:function(){if(!this._gpuAssignedOnce)switch(this._gpuAssignedOnce=this.gpu+"",this._gpuAssignedOnce){default:this._gpuAssignedOnce="2d";case"3d":case"2d":}return this._gpuAssignedOnce},_setTranslation:function(j,k){switch(this._gpu()){case"3d":this.translate3d(0,j+"px",0,k);break;case"2d":k.style.top=j+"px";}},_repositionBound:function(j){var k=j.location-j.offset-this._transformBaseline;this._setTranslation(k,j.element)},_applyTransform:function(){this._restyleMiddleHeight(),this._repositionHeader(),this._repositionFooter(),this._repositionMiddle()},_restyleMiddleHeight:function(){var j=this._middleHeight-this._transformBaseline;this.$.middle.style.height=j+"px"},_assignMiddleHeight:function(j){this._middleHeight=+j||0,this._restyleMiddleHeight()},_deltaMiddleHeight:function(j){var k=(+j||0)+this._middleHeight;this._assignMiddleHeight(k)},_repositionMiddle:function(){var j=this._headerHeight+this._transformBaseline;this._setTranslation(j,this.$.middle)},_repositionHeader:function(){var j=-(this._middleHeight-this._transformBaseline-this._scrollTop);this._setTranslation(j,this.$.header)},_repositionFooter:function(){var j=-(this._middleHeight-this._transformBaseline-this._scrollTop);j+=this._viewportHeight,this._setTranslation(j,this.$.footer)},pathAtIndex:function(j){return 0|j},indexFromPath:function(j){return Array.isArray(j)?1===j.length?0|j[0]:-1:0|j},hasMeasuredAnItem:function(){return 0|!!this._itemHeight},getHeightAtIndex:function(){var j=null;return this._itemHeight?this._recycler.getHeightAtIndex.apply(this._recycler,arguments):(j=Polymer.dom(this.$.middle).querySelector(".recycler-panel"),j&&h(j)||null)},getMaterializedIndices:function(j){var k=Array.isArray(j)?j:[],l=this._bindingList;return l&&l.reduce(this._assignYoungFromBoundReducer,k)},_assignYoungFromBoundReducer:function(j,k,l){return j[l]=k?k.young:-1,j},_getMaterializedBoundAtIndex:function(j){var k=0|j,l=null,m=this._bindingList,n=0|(m&&m.length),j=0;for(j=0;j<n;j++)if(l=m[j],l&&l.young===k)return l;return null},hasMaterializedIndex:function(j){return this._getMaterializedBoundAtIndex(j)?1:0},querySelectorAtIndex:function(j,k){var l=this._getMaterializedBoundAtIndex(k);return l&&l.element?Polymer.dom(l.element).querySelector(j):null},querySelectorAllAtIndex:function(j,k){var l=this._getMaterializedBoundAtIndex(k);return l&&l.element?Polymer.dom(l.element).querySelectorAll(j):null},getBoundingClientRectAtIndex:function(j){var k=this._getMaterializedBoundAtIndex(j);return k&&k.element?k.element.getBoundingClientRect():null},querySelectorOfHeader:function(j){return Polymer.dom(this.$.header).querySelector(j)},querySelectorAllOfHeader:function(j){return Polymer.dom(this.$.header).querySelectorAll(j)},getBoundingClientRectOfHeader:function(){return this.$.header.getBoundingClientRect()},querySelectorOfFooter:function(j){return Polymer.dom(this.$.footer).querySelector(j)},querySelectorAllOfFooter:function(j){return Polymer.dom(this.$.footer).querySelectorAll(j)},getBoundingClientRectOfFooter:function(){return this.$.footer.getBoundingClientRect()},getPaneScrollTop:function(){return this.$.pane.scrollTop},getPaneScrollLeft:function(){return this.$.pane.scrollLeft},getPaneScrollWidth:function(){return this.$.pane.scrollWidth},getPaneScrollHeight:function(){return this.$.pane.scrollHeight}})})(window.Strand=window.Strand||{});</script></body></html>